#!/usr/bin/env bash
# poor man's i3blocks, it's all I need really
# see: man swaybar-protocol
echo '{"version": 1}'
echo "["
while true; do

date=$(date '+%a %d.%m   %H:%M')

if [ "$(cat /sys/class/power_supply/BAT0/status)" = "Discharging" ]; then
	bat="ðŸ”‹ $(cat /sys/class/power_supply/BAT0/capacity)%"
else
	bat="ðŸ’« $(cat /sys/class/power_supply/BAT0/capacity)%"
fi

# see if we're chargin
charging=$(cat /sys/class/power_supply/BAT0/status	= "Charging")

if [ "$(cat /sys/class/power_supply/BAT0/status)" = "Discharging" ] && [ "$(cat /sys/class/power_supply/BAT0/capacity)" -lt "25" ]; then
	echo -n '[{"background": "#000000","color":"#ff0000","full_text":"  '
else
	echo -n '[{"background": "#000000","color":"#36f8ff","full_text":"  '
fi

case $HOSTNAME in
	carb) echo -n "$bat   $date";;
 	yharnam) echo -n "$date";;
esac
echo -n '  "}],'
echo
sleep 5;
done
